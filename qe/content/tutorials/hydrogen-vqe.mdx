---
title: H₂ Bond Length
description: Calculate the equilibrium bond length of H₂ with a variational quantum eigensolver
---

### Running VQE

1. Download the [yup](../../hydrogen.yaml) by right click on the link and select `Save Link As` and accept the defaults)
1. Submit the workflow with `qe submit workflow hydrogen.yaml`.
1. Monitor the status of your workflow with `qe get workflow workflow_id` where
`workflow_id` is the ID of your workflow.
1. After the workflow has completed, run `qe get workflowresult workflow_id` to request the workflow results.
1. Continue to run `qe get workflowresult workflow_id` until a URL with workflow results is returned.
1. Open the URL to download the JSON file with the workflow results.
1. Copy the python script below into the same directory as the JSON file.
1. In the python script, replace the name of the JSON file with the name of the JSON file that you have downloaded in Step 7.
1. Run the python script to plot the calculated binding energy curve.


```python
"""Plot the VQE binding energy curve of a diatomic molecule from a Quantum
Engine workflow result JSON."""

import json
from matplotlib import pyplot as plt

# Insert the path to your JSON file here
with open('d5f2be37-cece-5c1b-b099-ec867d50283c.json') as f:
    data = json.load(f)

# Extract lists of energies, bond lengths, and basis sets.
energies = []
bond_lengths = []
basis_sets = []
for task in data:
    if data[task]['class'] == 'optimize-variational-circuit':
        qubit_op = data[task]['inputArtifact:qubit-operator']
        qubit_op_creator = qubit_op.split('/')[0]
        interaction_op = data[qubit_op_creator]['inputArtifact:input-op']
        interaction_op_creator = interaction_op.split('/')[0]
        geometry = data[interaction_op_creator]['inputArtifact:geometry']
        geometry_creator = geometry.split('/')[0]
        bond_lengths.append(float(data[geometry_creator]['inputParam:bond-length']))
        energies.append(data[task]['optimization-results']['fun'])
        basis_sets.append(data[interaction_op_creator]['inputParam:basis'])

# Group the bond lengths and energies according to the basis set, and sort by
# bond length.
bond_length_sets = []
energy_sets = []
basis_set_list = list(set(basis_sets))
for basis in basis_set_list:
    indices = [i for i, x in enumerate(basis_sets) if x == basis]
    bond_length_sets.append([bond_lengths[i] for i in indices])
    energy_sets.append([energies[i] for i in indices])
    bond_length_sets[-1], energy_sets[-1] = zip(*sorted(zip(bond_length_sets[-1], energy_sets[-1]), key=lambda x: x[0]))

# Plot the binding energy curve
plt.figure()
for i in range(len(basis_set_list)):
    plt.plot(bond_length_sets[i], energy_sets[i])

plt.xlabel('Bond length (Angstrom)')
plt.ylabel('Energy (Ha)')
plt.legend(basis_set_list)
plt.show()
```
